{% extends 'bookmovielistapp/base.html' %}



{% block content %}
{% if user.is_authenticated %}
{{ error }}
{% for chapter in chapters %}
{{ chapter.name }}


{% for list in lists %}
    {% if list.name and list.chapter == chapter %}
        <table>
            <caption>
                {{ list.name }}
                <form action="{% url 'listdelete' list.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit">Delete</button>
                </form>
            </caption>
            <thead>
                <th>Название</th>
                <th>Автор/Режиссёр</th>
                <th>Описание</th>
                <th>Год выпуска</th>
                <th>Дата прочтения/просмотра</th>
            </thead>
            <tbody>
                {% for elem in elems %}
                    {% if elem.bookmovieid == list and elem.chapter == chapter %}
                        {% if elem.likes %}
                        <tr  style="background-color: green; color: white;">
                        {% else %}
                        <tr>
                        {% endif %}
                            <td>
                                {% if elem.name %}
                                        {{ elem.name }}
                                {% endif %}
                            </td>
                            <td>
                                {% if elem.author %}
                                        {{ elem.author }}
                                {% else %}
                                -
                                {% endif %}
                            </td>
                            <td>
                                {% if elem.description %}
                                        {{ elem.description}}
                                {% else %}
                                -
                                {% endif %}
                            </td>
                            <td>
                                {% if elem.year_of_issue %}
                                        {{ elem.year_of_issue|date:"Y" }}
                                {% else %}
                                -
                                {% endif %}
                            </td>
                            <td>
                                {% if elem.day_complete %}
                                        {{ elem.day_complete }}
                                {% else %}
                                -
                                {% endif %}
                            </td>
                            <td>
                                <form action="{% url 'elemdelete' elem.id %}" method="post">
                                    {% csrf_token %}
                                    <button type="submit">Delete</button>
                                </form>
                            </td>
                        </tr>
                    {% endif %}
                {% endfor %}
            </tbody>
        </table>
    {% endif %}
{% endfor %}


{% endfor %}

<form method="POST">
    {% csrf_token %}
    {{ form1.as_p }}
<button name="create_list" type="submit">Создать раздел</button>
</form>

<form method="POST" id="create_elems">
    {% csrf_token %}
    {{ form2.as_p }}
<button name="create_elem" type="submit">Создать раздел</button>
</form>
{% endif %}
{% endblock %}